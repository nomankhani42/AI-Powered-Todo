(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,82391,e=>{"use strict";let t;var s=e.i(43476),r=e.i(71645),a=e.i(18566),n=e.i(69620),o=e.i(54338),i=e.i(18831),l=e.i(88447),d=e.i(97057);e.i(1967);var c=e.i(48639),u=e.i(62502);e.i(47167);let m=(t="http://localhost:8000/api/v1".replace(/\/api\/v1\/?$/,""),`${t}/api/v1/agent`),h=async e=>{try{let t=null;try{t=localStorage.getItem("accessToken")}catch(e){console.warn("Could not access localStorage for token")}let s={"Content-Type":"application/json"};t&&t.trim()&&(s.Authorization=`Bearer ${t}`);let r=await fetch(`${m}/chat`,{method:"POST",headers:s,body:JSON.stringify({message:e})});if(!r.ok){let e=await r.json().catch(()=>({}));throw Error(e.detail||e.message||`Agent API error: ${r.statusText}`)}return await r.json()}catch(e){throw console.error("Agent API error:",e),e}};var x=e.i(30561);function g(){let e=(0,c.useDispatch)(),t=(0,c.useSelector)(e=>e.tasks.items),[a,n]=(0,r.useState)(!1),[o,i]=(0,r.useState)([{id:"1",text:"Hello! ðŸ‘‹ I'm your AI Task Manager Assistant. I can help you:\nâ€¢ Create tasks\nâ€¢ Update tasks\nâ€¢ Delete tasks\nâ€¢ Get task details\n\nJust describe what you'd like to do! You can also use voice commands ðŸŽ¤",sender:"bot",timestamp:new Date}]),[l,m]=(0,r.useState)(""),[g,p]=(0,r.useState)(!1),[b,f]=(0,r.useState)(!1),[w,y]=(0,r.useState)(!1),[k,v]=(0,r.useState)(""),j=(0,r.useRef)(null),N=(0,r.useRef)(null),S=(0,r.useRef)(null),C=(0,r.useRef)(null),T=(0,r.useRef)("");(0,r.useEffect)(()=>{T.current=l},[l]),(0,r.useEffect)(()=>{j.current?.scrollIntoView({behavior:"smooth"})},[o]),(0,r.useEffect)(()=>{{let e=window.SpeechRecognition||window.webkitSpeechRecognition;e&&(N.current=new e,N.current.continuous=!1,N.current.interimResults=!0,N.current.lang="en-US",N.current.onstart=()=>{y(!0),v("")},N.current.onresult=e=>{let t="";for(let s=e.resultIndex;s<e.results.length;s++){let r=e.results[s][0].transcript;e.results[s].isFinal?m(e=>e+r+" "):t+=r}v(t)},N.current.onerror=e=>{console.error("Speech recognition error:",e.error);let t="not-allowed"===e.error?"Microphone permission denied":`Voice error: ${e.error}`;i(e=>[...e,{id:Date.now().toString(),text:`âŒ ${t}`,sender:"bot",timestamp:new Date,isError:!0}])},N.current.onend=()=>{y(!1),v("")})}},[]),(0,r.useEffect)(()=>{let e=()=>{f(!!localStorage.getItem("accessToken"))};return e(),window.addEventListener("storage",e),()=>window.removeEventListener("storage",e)},[]),(0,r.useEffect)(()=>{let e=e=>{"Escape"===e.key&&a&&n(!1),"Space"===e.code&&a&&!g&&e.target===document.body&&(e.preventDefault(),D())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[a,g]);let E=async s=>{if(!s.trim())return;let r={id:Date.now().toString(),text:s,sender:"user",timestamp:new Date};i(e=>[...e,r]),p(!0);try{let r;if(!b){let e={id:(Date.now()+1).toString(),text:"âš ï¸ Please log in to use the task manager. The agent needs authentication to manage your tasks.",sender:"bot",timestamp:new Date,isError:!0};i(t=>[...t,e]),p(!1);return}if(r=s.toLowerCase(),["task","add","create","delete","remove","update","change","mark","completed","pending","priority","urgent","deadline","due","finish","complete","status","project","meeting"].some(e=>r.includes(e)))try{let r=await h(s),a={id:(Date.now()+1).toString(),text:r.message,sender:"bot",timestamp:new Date,isError:!r.success};if(i(e=>[...e,a]),r.success)switch(r.action){case"create":let n;n=r.task_data?.title||"task",d.toast.success(`âœ… Task "${n}" created!`);break;case"update":let o;o=r.task_data?.title||"task",d.toast.success(`âœ… Task "${o}" updated!`);break;case"delete":let l;l=r.task_data?.title||"task",d.toast.success(`âœ… Task "${l}" deleted!`);break;default:d.toast.success(`âœ… Operation completed completed!`)}if(r.success)try{let t=(await x.tasksService.getTasks()).tasks;t.length>0?e((0,u.setTasks)(t)):"delete"===r.action&&e((0,u.setTasks)(t)),e((0,u.clearError)())}catch(s){console.error("Failed to refresh task list:",s);try{if("delete"===r.action&&r.task_data?.id)e((0,u.deleteTask)(r.task_data.id));else if("update"===r.action&&r.task_data?.id){let s={id:r.task_data.id,owner_id:t[0]?.owner_id||"",title:r.task_data.title||"",status:r.task_data.status||"pending",priority:r.task_data.priority||"medium",created_at:new Date().toISOString(),updated_at:new Date().toISOString()};e((0,u.updateTask)(s))}}catch(e){console.error("Fallback Redux update also failed:",e)}}}catch(r){let e,t=r?.response?.data?.detail||r?.message||"Failed to process your request. Please try again.";e=t,d.toast.error(`âŒ Chat error: ${e||"Please try again"}`);let s={id:(Date.now()+1).toString(),text:`âŒ ${t}`,sender:"bot",timestamp:new Date,isError:!0};i(e=>[...e,s])}else{let e=A(s),t={id:(Date.now()+1).toString(),text:e,sender:"bot",timestamp:new Date};i(e=>[...e,t])}}finally{p(!1)}},I=async e=>{e.preventDefault(),l.trim()&&(m(""),await E(l))};(0,r.useEffect)(()=>{N.current&&(N.current.onend=()=>{y(!1),v(""),T.current.trim()&&(E(T.current.trim()),m(""))})},[E]);let D=()=>{if(!N.current)return void i(e=>[...e,{id:Date.now().toString(),text:"âŒ Speech recognition not supported in your browser. Please use Chrome, Edge, or Safari.",sender:"bot",timestamp:new Date,isError:!0}]);if(w)N.current.stop(),y(!1);else try{N.current.start()}catch(e){console.error("Error starting speech recognition:",e)}},A=e=>{let t=e.toLowerCase();return t.includes("hello")||t.includes("hi")||t.includes("hey")?"Hello! ðŸ‘‹ How can I assist you with your tasks today?":t.includes("help")||t.includes("what can you do")||t.includes("capabilities")?"I'm your Task Manager Assistant! I can:\nâ€¢ âœ… Create new tasks with details\nâ€¢ âœï¸ Update existing tasks\nâ€¢ ðŸ—‘ï¸ Delete tasks\nâ€¢ ðŸ“‹ Get task information\n\nðŸ’¡ Keyboard Shortcut: Press SPACEBAR to use voice commands!\n\nTry asking me things like:\n'Add a task called Buy groceries with high priority'\n'Mark my project as completed'\n'Delete the old task'":t.includes("thank")||t.includes("thanks")?"You're welcome! Feel free to ask if you need help with anything else. ðŸ˜Š":"I'm here to help you manage your tasks! Try asking me to:\nâ€¢ Create a new task\nâ€¢ Update a task\nâ€¢ Delete a task\nâ€¢ Get task details\n\nðŸ’¡ Tip: Click the ðŸŽ¤ button or press SPACEBAR for voice commands!\n\nWhat would you like to do?"};return(0,s.jsxs)(s.Fragment,{children:[a&&(0,s.jsxs)("div",{className:"fixed bottom-4 right-4 w-96 bg-white rounded-lg shadow-2xl flex flex-col z-40 max-sm:w-80 max-sm:bottom-2 max-sm:right-2",style:{height:"80vh",maxHeight:"calc(100vh - 2rem)"},children:[(0,s.jsxs)("div",{className:"bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-t-lg flex justify-between items-center",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h3",{className:"font-semibold text-lg",children:"AI Assistant"}),(0,s.jsx)("p",{className:"text-xs text-green-100",children:"Always here to help"})]}),(0,s.jsx)("button",{onClick:()=>n(!1),className:"text-white hover:bg-green-700 rounded-full p-1 transition",children:(0,s.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50 space-y-3",children:[o.map(e=>(0,s.jsx)("div",{className:`flex ${"user"===e.sender?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`max-w-xs px-4 py-2 rounded-lg ${"user"===e.sender?"bg-green-500 text-white rounded-br-none":e.isError?"bg-red-50 text-red-800 border border-red-200 rounded-bl-none":"bg-white text-gray-800 border border-gray-200 rounded-bl-none"}`,children:[(0,s.jsx)("p",{className:"text-sm whitespace-pre-wrap break-words",children:e.text}),(0,s.jsx)("p",{className:`text-xs mt-1 ${"user"===e.sender?"text-green-100":e.isError?"text-red-600":"text-gray-500"}`,children:e.timestamp.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]})},e.id)),g&&(0,s.jsx)("div",{className:"flex justify-start",children:(0,s.jsx)("div",{className:"bg-white border border-gray-200 rounded-lg rounded-bl-none px-4 py-2",children:(0,s.jsxs)("div",{className:"flex space-x-2",children:[(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce delay-100"}),(0,s.jsx)("div",{className:"w-2 h-2 bg-gray-500 rounded-full animate-bounce delay-200"})]})})}),(0,s.jsx)("div",{ref:j})]}),(0,s.jsxs)("div",{className:"border-t border-gray-200 p-4 bg-white rounded-b-lg",children:[w&&k&&(0,s.jsxs)("div",{className:"mb-2 p-2 bg-blue-50 border border-blue-200 rounded text-sm text-blue-700 italic",children:["ðŸŽ¤ ",k]}),(0,s.jsxs)("form",{ref:C,onSubmit:I,className:"flex gap-2",children:[(0,s.jsx)("input",{ref:S,type:"text",value:l,onChange:e=>m(e.target.value),placeholder:w?"Listening... ðŸŽ¤":"Type or speak...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-sm focus:outline-none focus:border-green-500",disabled:g}),(0,s.jsx)("button",{type:"button",onClick:D,disabled:g,title:w?"Stop listening":"Start voice command",className:`px-3 py-2 rounded-lg transition font-medium text-sm flex items-center gap-1 ${w?"bg-red-500 hover:bg-red-600 text-white":"bg-blue-500 hover:bg-blue-600 text-white"} disabled:opacity-50`,children:(0,s.jsx)("svg",{className:`w-5 h-5 ${w?"animate-pulse":""}`,fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M12 14c1.66 0 3-1.34 3-3V5c0-1.66-1.34-3-3-3S9 3.34 9 5v6c0 1.66 1.34 3 3 3zm5.3-3c0 3-2.54 5.1-5.3 5.1S6.7 14 6.7 11H5c0 3.41 2.72 6.23 6 6.72V21h2v-3.28c3.28-.48 6-3.3 6-6.72h-1.7z"})})}),(0,s.jsx)("button",{type:"submit",disabled:g||!l.trim(),className:"bg-green-500 hover:bg-green-600 disabled:bg-gray-400 text-white px-4 py-2 rounded-lg transition font-medium text-sm",children:(0,s.jsx)("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 19l9 2-9-18-9 18 9-2zm0 0v-8"})})})]})]})]}),!a&&(0,s.jsx)("button",{onClick:()=>n(!a),className:"fixed bottom-6 right-6 w-16 h-16 rounded-full shadow-lg hover:shadow-xl transition transform hover:scale-110 z-50 flex items-center justify-center bg-green-500 hover:bg-green-600 text-white",title:"Open chat",children:(0,s.jsx)("svg",{className:"w-8 h-8",fill:"currentColor",viewBox:"0 0 24 24",children:(0,s.jsx)("path",{d:"M16.6915026,12.4744748 L3.50612381,13.2599618 C3.19218622,13.2599618 3.03521743,13.4170592 3.03521743,13.5741566 L1.15159189,20.0151496 C0.8376543,20.8006365 0.99,21.89 1.77946707,22.52 C2.41,22.99 3.50612381,23.1 4.13399899,22.8429026 L21.714504,14.0454487 C22.6563168,13.5741566 23.1272231,12.6315722 22.9702544,11.6889879 L4.13399899,1.16151496 C3.34915502,0.9 2.40734225,0.9 1.77946707,1.4429026 C0.994623095,2.08535412 0.837654326,3.01492849 1.15159189,3.97751279 L3.03521743,10.4184309 C3.03521743,10.5755283 3.34915502,10.7326256 3.50612381,10.7326256 L16.6915026,11.5181125 C16.6915026,11.5181125 17.1624089,11.5181125 17.1624089,12.0609051 C17.1624089,12.4744748 16.6915026,12.4744748 16.6915026,12.4744748 Z"})})})]})}function p({children:e}){let t=(0,a.useRouter)(),c=(0,i.useAppDispatch)(),{isAuthenticated:u,user:m}=(0,o.useAuth)(),[h,x]=(0,r.useState)(!0),[p,b]=(0,r.useState)(!1);(0,r.useEffect)(()=>{let e=setTimeout(()=>{let e=!!localStorage.getItem("accessToken");u||e||t.push("/auth/login"),x(!1)},100);return()=>clearTimeout(e)},[u,t]);let f=!!localStorage.getItem("accessToken"),w=u||f;return h||!w?null:(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-white to-blue-50",children:[(0,s.jsx)("header",{className:"bg-white bg-opacity-80 backdrop-blur-xl border-b border-gray-200 sticky top-0 z-50 shadow-sm",children:(0,s.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-5",children:(0,s.jsxs)("div",{className:"flex justify-between items-center gap-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 min-w-0",children:[(0,s.jsx)("div",{className:"w-10 h-10 rounded-xl bg-gradient-to-br from-blue-500 to-cyan-600 flex items-center justify-center shadow-lg shadow-blue-500/20 flex-shrink-0",children:(0,s.jsx)(n.IoCheckmarkDone,{className:"w-6 h-6 text-white"})}),(0,s.jsxs)("div",{className:"min-w-0",children:[(0,s.jsx)("h1",{className:"text-xl sm:text-2xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent truncate",children:"AI Todo"}),(0,s.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 truncate",children:["Welcome, ",(0,s.jsx)("span",{className:"font-semibold text-gray-700",children:m?.name||m?.email||"User"})]})]})]}),(0,s.jsxs)("button",{onClick:()=>b(!0),className:"px-4 sm:px-6 py-2.5 sm:py-3 text-sm sm:text-base font-semibold text-red-600 bg-red-50 hover:bg-red-100 border border-red-200 hover:border-red-300 rounded-lg transition duration-200 flex items-center gap-2 whitespace-nowrap group",children:[(0,s.jsx)(n.IoLogOut,{className:"w-5 h-5 group-hover:translate-x-0.5 transition duration-200"}),"Sign Out"]})]})})}),(0,s.jsx)("main",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8 sm:py-10",children:e}),p&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"fixed inset-0 bg-transparent backdrop-blur-sm z-40 transition-opacity animate-in fade-in duration-300",onClick:()=>b(!1)}),(0,s.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-md border border-gray-100 animate-in zoom-in-95 duration-300 overflow-hidden",children:[(0,s.jsxs)("div",{className:"sticky top-0 z-20 bg-gradient-to-r from-white to-red-50 border-b border-gray-200 px-6 py-5 flex justify-between items-center backdrop-blur-xl",children:[(0,s.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Sign Out"}),(0,s.jsx)("button",{onClick:()=>b(!1),className:"p-2 hover:bg-gray-100 rounded-lg transition duration-200 text-gray-500 hover:text-gray-700",title:"Close",children:(0,s.jsx)(n.IoClose,{className:"w-6 h-6"})})]}),(0,s.jsxs)("div",{className:"p-8 bg-white",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsx)("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-red-100 to-red-50 flex items-center justify-center shadow-lg shadow-red-100/50",children:(0,s.jsx)(n.IoWarning,{className:"w-8 h-8 text-red-600"})})}),(0,s.jsx)("p",{className:"text-center text-gray-700 font-bold text-lg mb-2",children:"Are you sure?"}),(0,s.jsx)("p",{className:"text-center text-sm text-gray-600 mb-8",children:"You'll need to log in again to access your tasks and AI features."}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsx)("button",{type:"button",onClick:()=>b(!1),className:"flex-1 px-4 py-3 text-sm font-semibold text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition duration-200 transform hover:scale-105",children:"Cancel"}),(0,s.jsxs)("button",{type:"button",onClick:()=>{c((0,l.clearAuth)()),localStorage.removeItem("accessToken"),localStorage.removeItem("user"),b(!1),d.toast.success("âœ… Logged out successfully!"),t.push("/")},className:"flex-1 px-4 py-3 text-sm font-bold text-white bg-gradient-to-r from-red-500 to-red-600 hover:from-red-600 hover:to-red-700 rounded-lg transition duration-200 shadow-lg shadow-red-500/20 hover:shadow-red-500/40 transform hover:scale-105 flex items-center justify-center gap-2",children:[(0,s.jsx)(n.IoLogOut,{className:"w-4 h-4"}),"Sign Out"]})]})]})]})})]}),(0,s.jsx)(g,{})]})}e.s(["default",()=>p],82391)}]);